{"version":3,"file":"credit_card_payments_app_extension_schema.js","sourceRoot":"","sources":["../../../../../../src/cli/models/extensions/specifications/payments_app_extension_schemas/credit_card_payments_app_extension_schema.ts"],"names":[],"mappings":"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","sourcesContent":["import {BaseSchema} from '../../schemas.js'\nimport {zod} from '@shopify/cli-kit/node/schema'\n\nexport type CreditCardPaymentsAppExtensionConfigType = zod.infer<typeof CreditCardPaymentsAppExtensionSchema>\n\nconst MAX_LABEL_SIZE = 50\nconst CERTIFICATE_REGEX = /^-----BEGIN CERTIFICATE-----([\\s\\S]*)-----END CERTIFICATE-----\\s?$/\n\nexport const CREDIT_CARD_TARGET = 'payments.credit-card.render'\nexport const CreditCardPaymentsAppExtensionSchema = BaseSchema.extend({\n  targeting: zod.array(zod.object({target: zod.literal(CREDIT_CARD_TARGET)})).length(1),\n  api_version: zod.string(),\n  payment_session_url: zod.string().url(),\n  refund_session_url: zod.string().url(),\n  capture_session_url: zod.string().url(),\n  void_session_url: zod.string().url(),\n  verification_session_url: zod.string().url().optional(),\n  confirmation_callback_url: zod.string().url().optional(),\n  supports_3ds: zod.boolean(),\n  supported_countries: zod.array(zod.string()),\n  supported_payment_methods: zod.array(zod.string()),\n  supports_installments: zod.boolean(),\n  supports_deferred_payments: zod.boolean(),\n  test_mode_available: zod.boolean(),\n  merchant_label: zod.string().max(MAX_LABEL_SIZE),\n  encryption_certificate: zod.object({\n    fingerprint: zod.string(),\n    certificate: zod.string().regex(CERTIFICATE_REGEX),\n  }),\n  checkout_payment_method_fields: zod\n    .array(\n      zod.object({\n        type: zod.union([zod.literal('string'), zod.literal('number'), zod.literal('boolean')]),\n        required: zod.boolean(),\n        key: zod.string(),\n      }),\n    )\n    .optional(),\n  input: zod\n    .object({\n      metafield_identifiers: zod\n        .object({\n          namespace: zod.string(),\n          key: zod.string(),\n        })\n        .optional(),\n    })\n    .optional(),\n})\n  .refine((schema) => !schema.supports_3ds || schema.confirmation_callback_url, {\n    message: 'Property required when supports_3ds is true',\n    path: ['confirmation_callback_url'],\n  })\n  .refine((schema) => schema.supports_installments === schema.supports_deferred_payments, {\n    message: 'supports_installments and supports_deferred_payments must be the same',\n  })\n\nexport async function creditCardPaymentsAppExtensionDeployConfig(\n  config: CreditCardPaymentsAppExtensionConfigType,\n): Promise<{[key: string]: unknown} | undefined> {\n  return {\n    target: config.targeting[0]!.target,\n    api_version: config.api_version,\n    start_payment_session_url: config.payment_session_url,\n    start_refund_session_url: config.refund_session_url,\n    start_capture_session_url: config.capture_session_url,\n    start_void_session_url: config.void_session_url,\n    confirmation_callback_url: config.confirmation_callback_url,\n    merchant_label: config.merchant_label,\n    supported_countries: config.supported_countries,\n    supported_payment_methods: config.supported_payment_methods,\n    test_mode_available: config.test_mode_available,\n    supports_3ds: config.supports_3ds,\n    supports_deferred_payments: config.supports_deferred_payments,\n    supports_installments: config.supports_installments,\n    start_verification_session_url: config.verification_session_url,\n    encryption_certificate: config.encryption_certificate,\n    checkout_payment_method_fields: config.checkout_payment_method_fields,\n  }\n}\n"]}